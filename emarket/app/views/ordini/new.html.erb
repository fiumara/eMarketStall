<h2>Riepilogo Ordine</h2>

<h3>Codice Ordine: <%= @ordine.codice_ordine %></h3>


<table class="table">
  <thead>
    <tr>
      <th>Prodotto</th>
      <th>Quantità</th>
      <th>Prezzo</th>
      <th>Totale</th>
    </tr>
  </thead>
  <tbody>
    <% current_user.carrello.carrello_items.each do |item| %>
      <tr>
        <td><%= item.prodotto.nome_prodotto %></td>
        <td><%= item.quantity %></td>
        <td>€<%= item.prodotto.prezzo %></td>
        <td>€<%= item.prodotto.prezzo * item.quantity %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<p><strong>Totale: €<%= current_user.carrello.carrello_items.sum { |item| item.prodotto.prezzo * item.quantity } %></strong></p>

<%= form_with model: @ordine, url: ordini_path, method: :post do |f| %>
    <div>
      <%= f.label :indirizzo, "Indirizzo di spedizione:" %>
      <%= f.text_field :indirizzo, required: true %>
    </div>
    
    <%= f.submit "Procedi al pagamento", class: "btn btn-success" %>
  <% end %>
  