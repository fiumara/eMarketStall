<!DOCTYPE html>
<html>
<head>
    <title>Visualizzazione Prodotto</title>
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag 'application', media: 'all' %>
    <%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>
</head>
<body>
    <main>
        <h1><%= @prodotto.nome_prodotto %></h1>
        <div class="prodotto-container">
            <button class="arrow left">‹</button>
            <button class="arrow right">›</button>
            <div class="image-pagination">.....</div>
        </div>
        <div class="prodotto-details">
            <div class="prodotto-description">
                <h2>Descrizione</h2>
                <p><%= @prodotto.descrizione %></p>
                <%= link_to 'Visualizza Negozio', visualizza_negozio_path(@prodotto.negozio), class: 'store-button' %>
                <p>Prezzo: <%= number_to_currency(@prodotto.prezzo) %></p>

                <% if @promozione %>
                  <div class="promozione-attiva">
                  <h2>Promozione Attiva</h2>
                  <p><strong><%= @promozione.nome %></strong></p>
                  <p><%= @promozione.descrizione %></p>
                  <p>Sconto: <%= number_to_percentage(@promozione.sconto, precision: 2) %></p>
                  <p>Valida dal <%= @promozione.inizio.strftime("%d %b %Y") %> al <%= @promozione.fine.strftime("%d %b %Y") %></p>
                  </div>
                <% end %>

                <p>Categoria: <%= @prodotto.categorium.nome %></p> <!-- Mostra il nome della categoria -->

                <div class="reviews">
                    <p>Recensioni</p>
                    <span class="stars">★★★★★</span>
                    <button class="reviews-button">Vedi tutte le recensioni</button>
                </div>
            </div>
            <div class="prodotto-options">
                <label for="quantity">Quantità</label>
                <select id="quantity" name="quantity">
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                </select>
                <label for="size">Taglia/colore</label>
                <select id="size" name="size">
                    <option value="s">S</option>
                    <option value="m">M</option>
                    <option value="l">L</option>
                    <option value="xl">XL</option>
                </select>
                <label for="customization">Personalizzazione</label>
                <textarea id="customization" name="customization"></textarea>
                <button class="add-to-cart-button">Aggiungi al carrello</button>
            </div>
            <!-- Mostra il pulsante a forma di cuore solo agli utenti che non sono amministratori -->
      <% if unauthenticated_user? || session[:role] == 'acquirente' %>
        <div class="wishlist-button">
          <%= form_with url: add_to_wishlist_path(@prodotto), method: :post do %>
            <%= hidden_field_tag :redirect_back, request.original_url %>
            <%= submit_tag '❤', class: 'heart-button', id: 'wishlist-button' %>
          <% end %>
        </div>
      <% end %>
      
    </div>
  </main>
</body>
</html>





